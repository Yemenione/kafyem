import{l as j,k as N,r as n,j as e,B as f,a as d,t as l}from"./index-BAnfMb-m.js";import{I as m}from"./input-udRnJ2sz.js";import{A as k}from"./arrow-left-BUxlB15x.js";import{c as P}from"./createLucideIcon-C7dg4ryp.js";const _=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],w=P("save",_),E=()=>{const u=j(),{id:i}=N(),r=!!i,[p,x]=n.useState(!1),[h,y]=n.useState(r),[t,g]=n.useState({name:"",description:"",price:"",stock:"",category_name:"Honey",images:"",is_active:!0});n.useEffect(()=>{r&&(async()=>{try{const s=(await d.get(`https://api.yemenimarket.fr/api/products/${i}`)).data;g({name:s.name,description:s.description,price:s.price,stock:s.stock_quantity,category_name:s.categories?.name||"Honey",images:s.image_url||"",is_active:s.is_active})}catch(a){console.error("Error fetching product",a),l.error("Failed to load product data")}finally{y(!1)}})()},[i,r]);const c=o=>{const a=o.target.type==="checkbox"?o.target.checked:o.target.value;g({...t,[o.target.name]:a})},v=async o=>{o.preventDefault(),x(!0);try{const a="https://api.yemenimarket.fr",s={Authorization:`Bearer ${localStorage.getItem("token")}`};r?await d.put(`${a}/api/admin/products/${i}`,t,{headers:s}):await d.post(`${a}/api/admin/products`,t,{headers:s}),l.success(r?"Product Updated Successfully!":"Product Created Successfully!"),u("/admin/products")}catch(a){console.error(a),l.error(`Failed to ${r?"update":"create"} product`)}finally{x(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsxs(f,{variant:"ghost",onClick:()=>u("/admin/products"),children:[e.jsx(k,{className:"w-4 h-4 mr-2"})," Back"]}),e.jsx("h1",{className:"text-3xl font-serif font-bold text-coffee-dark",children:r?`Edit Product: ${t.name}`:"Add New Product"})]}),h?e.jsx("div",{className:"p-12 text-center text-gray-500 italic",children:"Loading product details..."}):e.jsx("div",{className:"bg-white rounded-lg shadow-md p-8",children:e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Product Name"}),e.jsx(m,{name:"name",value:t.name,onChange:c,required:!0,placeholder:"e.g. Royal Sidr Honey"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Category"}),e.jsxs("select",{name:"category_name",value:t.category_name,onChange:c,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"Honey",children:"Honey"}),e.jsx("option",{value:"Coffee",children:"Coffee"}),e.jsx("option",{value:"Spices",children:"Spices"}),e.jsx("option",{value:"Gifts",children:"Gifts"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:c,className:"flex min-h-[120px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Detailed product description..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Price ($)"}),e.jsx(m,{name:"price",type:"number",step:"0.01",value:t.price,onChange:c,required:!0,placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Stock Quantity"}),e.jsx(m,{name:"stock",type:"number",value:t.stock,onChange:c,required:!0,placeholder:"0"})]}),e.jsx("div",{className:"flex items-end pb-2",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"is_active",checked:t.is_active,onChange:c,className:"w-4 h-4 rounded text-gold focus:ring-gold"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Product is Active"})]})})]}),e.jsx("div",{className:"border-t pt-6 flex justify-end",children:e.jsx(f,{type:"submit",disabled:p,className:"bg-gold hover:bg-gold/90 text-coffee-dark font-bold px-8",children:p?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 mr-2"})," ",r?"Update Product":"Create Product"]})})})]})})]})};export{E as default};
