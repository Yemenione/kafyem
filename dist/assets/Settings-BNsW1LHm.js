import{r,a as x,j as s,B as v,t as g}from"./index-BAnfMb-m.js";import{I as N}from"./input-udRnJ2sz.js";import{R as k}from"./refresh-cw-BM576BUE.js";import"./createLucideIcon-C7dg4ryp.js";const B=()=>{const[u,n]=r.useState([]),[p,h]=r.useState(!0),[b,o]=r.useState(null);r.useEffect(()=>{d()},[]);const d=async()=>{try{const t="https://api.yemenimarket.fr",a=localStorage.getItem("token"),e=await x.get(`${t}/api/admin/config`,{headers:{Authorization:`Bearer ${a}`}});n(e.data)}catch(t){console.error("Failed to load settings",t)}finally{h(!1)}},c=async(t,a,e,i)=>{o(t);try{const m=localStorage.getItem("token");await x.put("http://localhost:5000/api/admin/config",{key:t,value:a,isPublic:e,description:i},{headers:{Authorization:`Bearer ${m}`}}),n(y=>y.map(l=>l.key===t?{...l,value:a,isPublic:e}:l)),g.success(`Setting '${t}' saved successfully`)}catch{g.error("Failed to save setting")}finally{o(null)}},j=u.reduce((t,a)=>{const e=a.group||"Other";return t[e]||(t[e]=[]),t[e].push(a),t},{});return p?s.jsx("div",{className:"p-8",children:"Loading settings..."}):s.jsxs("div",{className:"p-8 max-w-5xl mx-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-serif font-bold text-coffee-dark",children:"Store Settings"}),s.jsx("p",{className:"text-gray-500",children:"Manage technical configuration and keys."})]}),s.jsxs(v,{onClick:d,variant:"outline",children:[s.jsx(k,{className:"w-4 h-4 mr-2"})," Refresh"]})]}),s.jsx("div",{className:"space-y-8",children:Object.entries(j).map(([t,a])=>s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100",children:[s.jsxs("h2",{className:"text-xl font-bold capitalize mb-4 text-gold flex items-center gap-2",children:[t," Configuration"]}),s.jsx("div",{className:"space-y-4",children:a.map(e=>s.jsxs("div",{className:"grid grid-cols-12 gap-4 items-start border-b border-gray-50 pb-4 last:border-0 last:pb-0",children:[s.jsxs("div",{className:"col-span-4",children:[s.jsx("label",{className:"text-sm font-bold text-gray-700 block",children:e.key}),s.jsx("span",{className:"text-xs text-gray-400 block mt-1",children:e.description||"No description"})]}),s.jsxs("div",{className:"col-span-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx(N,{type:e.key.includes("pass")||e.key.includes("secret")?"password":"text",defaultValue:e.value,className:"pr-10",onBlur:i=>{i.target.value!==e.value&&c(e.key,i.target.value,e.isPublic,e.description)}}),b===e.key&&s.jsx("span",{className:"absolute right-3 top-2.5 text-xs text-gold animate-pulse",children:"Saving..."})]}),e.type==="image"&&e.value&&s.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded border border-gray-100 inline-block",children:s.jsx("img",{src:e.value,alt:"Preview",className:"h-12 object-contain"})})]}),s.jsx("div",{className:"col-span-2 flex items-center justify-end",children:s.jsx("button",{onClick:()=>c(e.key,e.value,!e.isPublic,e.description),className:`p-2 rounded-md transition-colors ${e.isPublic?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,title:e.isPublic?"Public (Visible to Frontend)":"Private (Backend Only)",children:e.isPublic?s.jsx(Globe,{size:18}):s.jsx(Lock,{size:18})})})]},e.key))})]},t))})]})};export{B as default};
